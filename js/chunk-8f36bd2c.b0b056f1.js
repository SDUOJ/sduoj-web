(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8f36bd2c"],{"0a9c":function(t,e,r){"use strict";var a=r("bc9e"),n=r.n(a);n.a},"0b67":function(t,e,r){"use strict";var a=r("23c2"),n=r.n(a);n.a},1722:function(t,e,r){},"23c2":function(t,e,r){},"278d":function(t,e,r){},"29f5":function(t,e,r){"use strict";var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("div",{staticClass:"center"},[r("Form",{ref:"registerForm",attrs:{model:t.registerForm,rules:t.registerRules,"label-position":"right"}},[r("FormItem",{attrs:{prop:"username",label:"Username"}},[r("Input",{staticStyle:{width:"280px"},attrs:{placeholder:"Your login handler"},model:{value:t.registerForm.username,callback:function(e){t.$set(t.registerForm,"username",e)},expression:"registerForm.username"}})],1),r("FormItem",{attrs:{prop:"email",label:"Email"}},[r("Input",{staticStyle:{width:"280px"},attrs:{type:"email"},model:{value:t.registerForm.email,callback:function(e){t.$set(t.registerForm,"email",e)},expression:"registerForm.email"}})],1),r("FormItem",{attrs:{prop:"password",label:"Password"}},[r("Input",{staticStyle:{width:"280px"},attrs:{placeholder:"At least 6 characters",type:"password"},model:{value:t.registerForm.password,callback:function(e){t.$set(t.registerForm,"password",e)},expression:"registerForm.password"}})],1),r("FormItem",{attrs:{prop:"confirmPassword",label:"Confirm Password"}},[r("Input",{staticStyle:{width:"280px"},attrs:{placeholder:"Same as your password",type:"password"},model:{value:t.registerForm.confirmPassword,callback:function(e){t.$set(t.registerForm,"confirmPassword",e)},expression:"registerForm.confirmPassword"}})],1),""===t.token?r("div",[r("FormItem",{attrs:{label:"Student ID"}},[r("Input",{staticStyle:{width:"280px"},model:{value:t.registerForm.studentId,callback:function(e){t.$set(t.registerForm,"studentId",e)},expression:"registerForm.studentId"}})],1),r("FormItem",{attrs:{prop:"captcha",label:"Captcha"}},[r("div",{staticClass:"captcha-code"},[r("Input",{staticStyle:{width:"280px"},attrs:{placeholder:"Click to get captcha"},on:{"on-focus":t.onCaptchaInputFocus},model:{value:t.registerForm.captcha,callback:function(e){t.$set(t.registerForm,"captcha",e)},expression:"registerForm.captcha"}})],1),r("div",{staticClass:"captcha-img"},[r("Tooltip",{attrs:{content:"Click to refresh",placement:"right"}},[r("img",{attrs:{src:t.captchaImg},on:{click:t.getCaptcha}})])],1)])],1):t._e()],1)],1),r("div",{staticClass:"btnGroup",staticStyle:{"margin-top":"-1px"}},[r("Button",{staticClass:"btn",attrs:{type:"error",long:"",size:"large",loading:t.btnRegisterLoading},on:{click:t.handleRegister}},[t._v(t._s(t.registerText))]),""===t.token?r("Button",{staticClass:"btn",attrs:{long:"",to:{name:"login"}}},[t._v("Already registered")]):t._e()],1)])},n=[],s=(r("d3b7"),r("7c15")),i={name:"AccountRegisterForm",props:{token:{type:String,default:""},registerText:{type:String,default:"Register"}},data:function(){var t=this,e=function(e,r,a){s["a"].isExist({username:r}).then((function(t){t?a(new Error("already exists")):a()})).catch((function(e){t.$Message.error(e.message)}))},r=function(e,r,a){s["a"].isExist({email:r}).then((function(t){t?a(new Error("already exists")):a()})).catch((function(e){t.$Message.error(e.message)}))},a=function(e,r,a){""!==r&&t.$refs.registerForm.validateField("confirmPassword"),a()},n=function(e,r,a){r!==t.registerForm.password&&a(new Error("Password does not match")),a()};return{registerForm:{username:"",email:"",password:"",confirmPassword:"",studentId:"",captcha:""},registerRules:{username:[{required:!0,trigger:"blur"},{validator:e,trigger:"blur"}],email:[{required:!0,type:"email",trigger:"blur"},{validator:r,trigger:"blur"}],password:[{required:!0,trigger:"blur",min:6,max:32},{validator:a,trigger:"blur"}],confirmPassword:[{required:!0,validator:n,trigger:"change"}],captcha:[{required:!0,trigger:"blur",min:1,max:10}]},captchaId:0,captchaImg:"",btnRegisterLoading:!1}},methods:{getCaptcha:function(){var t=this;s["a"].getCaptcha().then((function(e){t.captchaId=e.captchaId,t.captchaImg=e.captcha})).catch((function(e){t.$Message.error(e.message)}))},resetCaptcha:function(){this.registerForm.captcha="",this.getCaptcha()},onCaptchaInputFocus:function(){this.captchaId||this.getCaptcha()},handleRegister:function(){var t=this;this.$refs.registerForm.validate((function(e){if(e){var r=Object.assign({},t.registerForm),a="register";return delete r.confirmPassword,""===t.token?r.captchaId=t.captchaId:(delete r.studentId,delete r.captcha,delete r.captchaId,r.token=t.token,a="thirdPartyRegister"),t.btnRegisterLoading=!0,void s["a"][a](r).then((function(e){t.$emit("on-success",e),t.$refs.registerForm.resetFields()})).catch((function(e){t.$Message.error(e.message)})).finally((function(){t.btnRegisterLoading=!1,""===t.token&&t.resetCaptcha()}))}""===t.token&&t.resetCaptcha()}))}}},o=i,c=(r("c849"),r("2877")),d=Object(c["a"])(o,a,n,!1,null,"66774b84",null);e["a"]=d.exports},"3abf":function(t,e,r){"use strict";r.d(e,"b",(function(){return i})),r.d(e,"a",(function(){return o}));r("99af"),r("d3b7");var a=r("ade3"),n=r("7c15"),s="/thirdPartyLogin?thirdParty=",i={SDUCAS:"SDUCAS"},o=Object(a["a"])({},i.SDUCAS,{name:"SDUCAS",description:"Shandong University Central Authentication Service",targetUrl:function(t){var e="https://pass.sdu.edu.cn/cas/login?service=".concat(location.origin).concat(s).concat(i.SDUCAS);for(var r in t)e+="&".concat(r,"=").concat(t[r]);return e},certificate:function(t){return new Promise((function(e,r){n["a"].thirdPartyLogin(t).then((function(t){e(t)})).catch(r)}))},render:function(t,e){var r="".concat(e.sduRealName,"(").concat(e.sduId,") has passed SDU CAS certification"),a="Please complete the following information",n=t("div",{class:{center:!0},style:{color:"#000000A6"}},r),s=t("div",{class:{center:!0},style:{color:"#000000A6"}},a);return t("div",[n,s])},getId:function(t){return t.sduId}})},"3b37":function(t,e,r){"use strict";var a=r("278d"),n=r.n(a);n.a},"7f8a":function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return t.valid?r("div",{staticClass:"container clearfix"},[t.ready?r("div",[r("Bind",{ref:"bind"})],1):r("div",[r("div",{staticClass:"waitTip"},[r("div",[t._v("Waiting for response")]),r("span",[t._v(t._s(t.thirdParty.description))])]),t._m(0)])]):t._e()},n=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"loader"},[r("div",{staticClass:"square"}),r("div",{staticClass:"square"}),r("div",{staticClass:"square last"}),r("div",{staticClass:"square clear"}),r("div",{staticClass:"square"}),r("div",{staticClass:"square last"}),r("div",{staticClass:"square clear"}),r("div",{staticClass:"square"}),r("div",{staticClass:"square last"})])}],s=(r("ac1f"),r("5319"),r("5530")),i=(r("1722"),r("3abf")),o=r("2f62"),c=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"box clearfix"},[""!==t.params.thirdParty?r("div",{staticClass:"bindWrapper"},[r("div",{staticClass:"bindHeader"},[t._m(0),r("div",{staticClass:"bindTip"},[r("AuthTip",{attrs:{"third-party-params":t.params}})],1)]),r("Divider"),""!==t.params.token?r("div",[t.bindType?r("AccountLoginForm",{attrs:{token:t.params.token,"login-text":"Login and Bind"},on:{"on-success":t.handleBindAccount}}):r("AccountRegisterForm",{attrs:{token:t.params.token,"register-text":"Register and Bind"},on:{"on-success":t.handleBindAccount}})],1):t._e(),r("div",{staticClass:"bindBottom center"},[t.bindType?r("a",{attrs:{href:"javascript:void(0)"},on:{click:function(e){return t.onChangeBindType(!1)}}},[t._v("No account")]):r("a",{attrs:{href:"javascript:void(0)"},on:{click:function(e){return t.onChangeBindType(!0)}}},[t._v("Bind existing account")])])],1):t._e()])},d=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("header",{staticClass:"bindTitle center"},[r("h3",[t._v("Continue to bind third party account")])])}],u=r("d12f"),l=r("29f5"),m={name:"ThirdPartyHint",props:{thirdPartyParams:Object},render:function(t){var e=i["a"][this.thirdPartyParams.thirdParty];return e?e.render(t,this.thirdPartyParams):t("div")}},p={name:"Bind",components:{AccountLoginForm:u["a"],AccountRegisterForm:l["a"],AuthTip:m},data:function(){return{params:{},bindType:!0}},methods:Object(s["a"])(Object(s["a"])({},Object(o["b"])("user",["setProfile"])),{},{set:function(t){this.params=t},onChangeBindType:function(t){this.bindType=t},handleBindAccount:function(t){this.setProfile(t),this.$router.replace({name:"home"})}})},g=p,h=(r("3b37"),r("2877")),f=Object(h["a"])(g,c,d,!1,null,"f4b94162",null),v=f.exports,b={name:"ThirdPartyLogin",components:{Bind:v},data:function(){return{thirdParty:{},valid:!1,ready:!1}},methods:Object(s["a"])({},Object(o["b"])("user",["setProfile"])),mounted:function(){var t=this;for(var e in this.valid=!1,this.ready=!1,i["b"])i["b"][e]===this.$route.query.thirdParty&&(this.valid=!0,this.thirdParty=i["a"][i["b"][e]]);this.valid?this.thirdParty.certificate(this.$route.query).then((function(e){e.user?(t.setProfile(e.user),t.$router.replace({name:"home"})):(t.ready=!0,t.$nextTick((function(){t.$refs.bind.set(e)})))})).catch((function(e){t.$Message.error(e.message),t.$router.replace({name:"login"})})):this.$Message.error("Invalid Parameters")}},y=b,F=(r("0a9c"),Object(h["a"])(y,a,n,!1,null,"a3e7a030",null));e["default"]=F.exports},ac70:function(t,e,r){},bc9e:function(t,e,r){},c849:function(t,e,r){"use strict";var a=r("ac70"),n=r.n(a);n.a},d12f:function(t,e,r){"use strict";var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("div",{staticClass:"center"},[r("Form",{ref:"accountLoginForm",attrs:{model:t.accountLoginForm,rules:t.accountLoginRules,"label-position":"right"}},[r("FormItem",{attrs:{prop:"username",label:"Username (or Email)"}},[r("Input",{staticStyle:{width:"280px"},model:{value:t.accountLoginForm.username,callback:function(e){t.$set(t.accountLoginForm,"username",e)},expression:"accountLoginForm.username"}})],1),r("FormItem",{attrs:{prop:"password",label:"Password"}},[r("Input",{staticStyle:{width:"280px"},attrs:{type:"password"},on:{"on-enter":t.handleAccountLogin},model:{value:t.accountLoginForm.password,callback:function(e){t.$set(t.accountLoginForm,"password",e)},expression:"accountLoginForm.password"}})],1)],1)],1),r("div",{staticClass:"btnGroup",staticStyle:{"margin-top":"-1px"}},[r("Button",{staticClass:"btn",attrs:{type:"error",long:"",size:"large",loading:t.btnAccountLoginLoading},on:{click:t.handleAccountLogin}},[t._v(t._s(t.loginText))]),""===t.token?r("Button",{staticClass:"btn",attrs:{long:"",to:{name:"reset-password"}}},[t._v("Forget password")]):t._e()],1)])},n=[],s=(r("d3b7"),r("7c15")),i={name:"AccountLoginForm",props:{token:{type:String,default:""},loginText:{type:String,default:"Login"}},data:function(){return{accountLoginForm:{username:"",password:""},accountLoginRules:{username:[{required:!0,trigger:"blur"}],password:[{required:!0,trigger:"blur"}]},btnAccountLoginLoading:!1}},methods:{handleAccountLogin:function(){var t=this;this.$refs.accountLoginForm.validate((function(e){if(e){var r="login",a=t.accountLoginForm;""!==t.token&&(r="thirdPartyBinding",a.token=t.token),t.btnAccountLoginLoading=!0,s["a"][r](a).then((function(e){t.$emit("on-success",e)})).catch((function(e){t.$Message.error(e.message)})).finally((function(){t.btnAccountLoginLoading=!1}))}}))}}},o=i,c=(r("0b67"),r("2877")),d=Object(c["a"])(o,a,n,!1,null,"1ed6eed5",null);e["a"]=d.exports}}]);
//# sourceMappingURL=chunk-8f36bd2c.b0b056f1.js.map