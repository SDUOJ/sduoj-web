{"version":3,"sources":["webpack:///./src/views/user/ResetPass.vue?7f3c","webpack:///src/views/user/ResetPass.vue","webpack:///./src/views/user/ResetPass.vue?7d9c","webpack:///./src/views/user/ResetPass.vue","webpack:///./node_modules/core-js/modules/es.array.index-of.js","webpack:///./src/views/user/ResetPass.vue?275f"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","_m","ref","attrs","resetForm","resetRules","staticStyle","model","value","callback","$$v","$set","expression","on","onCaptchaInputFocus","captchaImg","getCaptcha","btnResetLoading","$event","handleReset","_v","staticRenderFns","data","Error","handler","captcha","password","confirmPassword","captchaId","token","apply","methods","$refs","name","validate","valid","username","email","dataForm","api","content","onClose","mounted","$route","query","$Message","success","component","$","$indexOf","indexOf","arrayMethodIsStrict","arrayMethodUsesToLength","nativeIndexOf","NEGATIVE_ZERO","STRICT_METHOD","USES_TO_LENGTH","ACCESSORS","1","target","proto","forced","searchElement","arguments","length","undefined"],"mappings":"uHAAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,gBAAgB,CAACN,EAAIO,GAAG,GAAGH,EAAG,MAAM,CAACE,YAAY,QAAQ,CAACF,EAAG,OAAO,CAACI,IAAI,YAAYC,MAAM,CAAC,MAAQT,EAAIU,UAAU,MAAQV,EAAIW,WAAW,iBAAiB,QAAQ,cAAc,IAAI,aAAa,KAAK,CAAEX,EAAS,MAAE,CAACI,EAAG,WAAW,CAACK,MAAM,CAAC,KAAO,UAAU,MAAQ,sBAAsB,CAACL,EAAG,QAAQ,CAACQ,YAAY,CAAC,MAAQ,SAASH,MAAM,CAAC,YAAc,qBAAqBI,MAAM,CAACC,MAAOd,EAAIU,UAAiB,QAAEK,SAAS,SAAUC,GAAMhB,EAAIiB,KAAKjB,EAAIU,UAAW,UAAWM,IAAME,WAAW,wBAAwB,IAAI,CAACd,EAAG,WAAW,CAACK,MAAM,CAAC,KAAO,WAAW,MAAQ,iBAAiB,CAACL,EAAG,QAAQ,CAACQ,YAAY,CAAC,MAAQ,SAASH,MAAM,CAAC,YAAc,wBAAwB,KAAO,YAAYI,MAAM,CAACC,MAAOd,EAAIU,UAAkB,SAAEK,SAAS,SAAUC,GAAMhB,EAAIiB,KAAKjB,EAAIU,UAAW,WAAYM,IAAME,WAAW,yBAAyB,GAAGd,EAAG,WAAW,CAACK,MAAM,CAAC,KAAO,kBAAkB,MAAQ,yBAAyB,CAACL,EAAG,QAAQ,CAACQ,YAAY,CAAC,MAAQ,SAASH,MAAM,CAAC,YAAc,+BAA+B,KAAO,YAAYI,MAAM,CAACC,MAAOd,EAAIU,UAAyB,gBAAEK,SAAS,SAAUC,GAAMhB,EAAIiB,KAAKjB,EAAIU,UAAW,kBAAmBM,IAAME,WAAW,gCAAgC,IAAId,EAAG,WAAW,CAACK,MAAM,CAAC,KAAO,UAAU,MAAQ,YAAY,CAACL,EAAG,MAAM,CAACE,YAAY,gBAAgB,CAACF,EAAG,QAAQ,CAACQ,YAAY,CAAC,MAAQ,SAASH,MAAM,CAAC,YAAc,wBAAwBU,GAAG,CAAC,WAAWnB,EAAIoB,qBAAqBP,MAAM,CAACC,MAAOd,EAAIU,UAAiB,QAAEK,SAAS,SAAUC,GAAMhB,EAAIiB,KAAKjB,EAAIU,UAAW,UAAWM,IAAME,WAAW,wBAAwB,GAAGd,EAAG,MAAM,CAACE,YAAY,eAAe,CAACF,EAAG,UAAU,CAACK,MAAM,CAAC,QAAU,mBAAmB,UAAY,UAAU,CAACL,EAAG,MAAM,CAACK,MAAM,CAAC,IAAMT,EAAIqB,YAAYF,GAAG,CAAC,MAAQnB,EAAIsB,iBAAiB,MAAM,IAAI,GAAGlB,EAAG,MAAM,CAACE,YAAY,UAAU,CAACF,EAAG,MAAM,CAACE,YAAY,QAAQ,CAACF,EAAG,SAAS,CAACK,MAAM,CAAC,KAAO,OAAO,QAAUT,EAAIuB,iBAAiBJ,GAAG,CAAC,MAAQ,SAASK,GAAQ,OAAOxB,EAAIyB,YAAY,gBAAgB,CAACzB,EAAI0B,GAAG,YAAY,QAC/hEC,EAAkB,CAAC,WAAa,IAAI3B,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,SAAS,CAACF,EAAG,OAAO,CAACJ,EAAI0B,GAAG,6B,sDC0E5J,GACEE,KAAM,WAAR,WACA,kBACoB,KAAVd,GACF,EAAR,iDAEMC,KAEN,kBACUD,IAAU,EAApB,oBACQC,EAAS,IAAIc,MAAM,4BAErBd,KAEF,MAAO,CACLL,UAAW,CACToB,QAAS,GACTC,QAAS,GACTC,SAAU,GACVC,gBAAiB,IAEnBtB,WAAY,CACVmB,QAAS,CACjB,CAAU,UAAV,EAAU,QAAV,SAEQC,QAAS,CACjB,CAAU,UAAV,EAAU,QAAV,SAEQC,SAAU,CAClB,CAAU,UAAV,EAAU,QAAV,OAAU,IAAV,EAAU,IAAV,IACA,CAAU,UAAV,EAAU,QAAV,SAEQC,gBAAiB,CACzB,CAAU,UAAV,EAAU,UAAV,EAAU,QAAV,YAGMV,iBAAiB,EACjBW,UAAW,GACXb,WAAY,GACZc,MAAO,GACPC,OAAO,IAGXC,QAAS,CACPZ,YAAa,SAAjB,cACMxB,KAAKqC,MAAMC,GAAMC,UAAS,SAAhC,GACQ,GAAKC,EAGL,GAAI,EAAZ,OACU,IAAV,GACYC,SAAU,EAAtB,kBACYC,MAAO,EAAnB,kBACYZ,QAAS,EAArB,kBACYG,UAAW,EAAvB,YAEA,IAAc,EAAd,sCAEmBU,EAASF,gBAGTE,EAASD,MAElBE,EAAV,yCACY,EAAZ,6CACA,mBACY,EAAZ,0BACY,EAAZ,gBACA,oBACY,EAAZ,qBACY,EAAZ,4BAEA,CACU,IAAV,GACYV,MAAO,EAAnB,MACYH,SAAU,EAAtB,mBACYD,QAAS,EAArB,kBACYG,UAAW,EAAvB,WAEUW,EAAV,wCACY,EAAZ,kBACcC,QAAS,kCACTC,QAAS,WAAvB,+CAEA,mBACY,EAAZ,kCAKI3B,oBAAqB,WACdnB,KAAKiC,WACRjC,KAAKqB,cAGTA,WAAY,WAAhB,WACMuB,EAAN,oCACQ,EAAR,sBACQ,EAAR,0BAIEG,QAAS,WACH/C,KAAKgD,OAAOC,MAAMf,QACpBlC,KAAKkC,MAAQlC,KAAKgD,OAAOC,MAAMf,MAC/BlC,KAAKmC,OAAQ,EACbnC,KAAKkD,SAASC,QAAQ,0BCrLsU,I,wBCQ9VC,EAAY,eACd,EACAtD,EACA4B,GACA,EACA,KACA,WACA,MAIa,aAAA0B,E,oEClBf,IAAIC,EAAI,EAAQ,QACZC,EAAW,EAAQ,QAA+BC,QAClDC,EAAsB,EAAQ,QAC9BC,EAA0B,EAAQ,QAElCC,EAAgB,GAAGH,QAEnBI,IAAkBD,GAAiB,EAAI,CAAC,GAAGH,QAAQ,GAAI,GAAK,EAC5DK,EAAgBJ,EAAoB,WACpCK,EAAiBJ,EAAwB,UAAW,CAAEK,WAAW,EAAMC,EAAG,IAI9EV,EAAE,CAAEW,OAAQ,QAASC,OAAO,EAAMC,OAAQP,IAAkBC,IAAkBC,GAAkB,CAC9FN,QAAS,SAAiBY,GACxB,OAAOR,EAEHD,EAAcvB,MAAMnC,KAAMoE,YAAc,EACxCd,EAAStD,KAAMmE,EAAeC,UAAUC,OAAS,EAAID,UAAU,QAAKE,O,kCCnB5E,yBAAwnB,EAAG","file":"js/chunk-a7d0c1f6.fb3a3a92.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"box clearfix\"},[_vm._m(0),_c('div',{staticClass:\"body\"},[_c('Form',{ref:\"resetForm\",attrs:{\"model\":_vm.resetForm,\"rules\":_vm.resetRules,\"label-position\":\"right\",\"label-width\":150,\"label-colo\":\"\"}},[(_vm.apply)?[_c('FormItem',{attrs:{\"prop\":\"handler\",\"label\":\"Username or Email\"}},[_c('Input',{staticStyle:{\"width\":\"220px\"},attrs:{\"placeholder\":\"Username or Email\"},model:{value:(_vm.resetForm.handler),callback:function ($$v) {_vm.$set(_vm.resetForm, \"handler\", $$v)},expression:\"resetForm.handler\"}})],1)]:[_c('FormItem',{attrs:{\"prop\":\"password\",\"label\":\"New Password\"}},[_c('Input',{staticStyle:{\"width\":\"220px\"},attrs:{\"placeholder\":\"At least 6 characters\",\"type\":\"password\"},model:{value:(_vm.resetForm.password),callback:function ($$v) {_vm.$set(_vm.resetForm, \"password\", $$v)},expression:\"resetForm.password\"}})],1),_c('FormItem',{attrs:{\"prop\":\"confirmPassword\",\"label\":\"Confirm New Password\"}},[_c('Input',{staticStyle:{\"width\":\"220px\"},attrs:{\"placeholder\":\"Be same as your new password\",\"type\":\"password\"},model:{value:(_vm.resetForm.confirmPassword),callback:function ($$v) {_vm.$set(_vm.resetForm, \"confirmPassword\", $$v)},expression:\"resetForm.confirmPassword\"}})],1)],_c('FormItem',{attrs:{\"prop\":\"captcha\",\"label\":\"Captcha\"}},[_c('div',{staticClass:\"captcha-code\"},[_c('Input',{staticStyle:{\"width\":\"220px\"},attrs:{\"placeholder\":\"Click to get captcha\"},on:{\"on-focus\":_vm.onCaptchaInputFocus},model:{value:(_vm.resetForm.captcha),callback:function ($$v) {_vm.$set(_vm.resetForm, \"captcha\", $$v)},expression:\"resetForm.captcha\"}})],1),_c('div',{staticClass:\"captcha-img\"},[_c('Tooltip',{attrs:{\"content\":\"Click to refresh\",\"placement\":\"right\"}},[_c('img',{attrs:{\"src\":_vm.captchaImg},on:{\"click\":_vm.getCaptcha}})])],1)])],2)],1),_c('div',{staticClass:\"bottom\"},[_c('div',{staticClass:\"btns\"},[_c('Button',{attrs:{\"type\":\"text\",\"loading\":_vm.btnResetLoading},on:{\"click\":function($event){return _vm.handleReset('resetForm')}}},[_vm._v(\"Reset\")])],1)])])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"title\"},[_c('span',[_vm._v(\"Reset your password\")])])}]\n\nexport { render, staticRenderFns }","<!--\n   Copyright 2020-2020 the original author or authors.\n\n   Licensed under the General Public License, Version 3.0 (the \"License\");\n   you may not use this file except in compliance with the License.\n   You may obtain a copy of the License at\n\n        https://www.gnu.org/licenses/gpl-3.0.en.html\n -->\n\n<template>\n  <div class=\"box clearfix\">\n      <div class=\"title\">\n          <span>Reset your password</span>\n      </div>\n      <div class=\"body\">\n        <Form ref=\"resetForm\"\n          :model=\"resetForm\"\n          :rules=\"resetRules\"\n          label-position=\"right\"\n          :label-width=\"150\"\n          label-colo>\n          <template v-if=\"apply\">\n            <FormItem prop=\"handler\" label=\"Username or Email\">\n              <Input v-model=\"resetForm.handler\" placeholder=\"Username or Email\" style=\"width: 220px\" />\n            </FormItem>\n          </template>\n          <template v-else>\n            <FormItem prop=\"password\" label=\"New Password\">\n              <Input\n                v-model=\"resetForm.password\"\n                placeholder=\"At least 6 characters\"\n                style=\"width: 220px\"\n                type=\"password\"\n              />\n            </FormItem>\n            <FormItem prop=\"confirmPassword\" label=\"Confirm New Password\">\n              <Input\n                v-model=\"resetForm.confirmPassword\"\n                placeholder=\"Be same as your new password\"\n                style=\"width: 220px\"\n                type=\"password\"\n              />\n            </FormItem>\n            </template>\n            <FormItem prop=\"captcha\" label=\"Captcha\">\n              <div class=\"captcha-code\">\n                <Input\n                  v-model=\"resetForm.captcha\"\n                  placeholder=\"Click to get captcha\"\n                  style=\"width: 220px\"\n                  @on-focus=\"onCaptchaInputFocus\"\n                />\n              </div>\n              <div class=\"captcha-img\">\n                <Tooltip content=\"Click to refresh\" placement=\"right\">\n                  <img :src=\"captchaImg\" @click=\"getCaptcha\"/>\n                </Tooltip>\n              </div>\n            </FormItem>\n        </Form>\n      </div>\n      <div class=\"bottom\">\n        <div class=\"btns\">\n          <Button type=\"text\"\n            @click=\"handleReset('resetForm')\"\n            :loading=\"btnResetLoading\">Reset</Button>\n        </div>\n      </div>\n  </div>\n</template>\n\n<script>\nimport api from '_u/api';\n\nexport default {\n  data: function() {\n    const validatePass = (rule, value, callback) => {\n      if (value !== '') {\n        this.$refs.resetForm.validateField('confirmPassword');\n      }\n      callback();\n    };\n    const validateConfirmPass = (rule, value, callback) => {\n      if (value !== this.resetForm.password) {\n        callback(new Error('Password does not match'));\n      }\n      callback();\n    };\n    return {\n      resetForm: {\n        handler: '',\n        captcha: '',\n        password: '',\n        confirmPassword: ''\n      },\n      resetRules: {\n        handler: [\n          { required: true, trigger: 'blur' }\n        ],\n        captcha: [\n          { required: true, trigger: 'blur' }\n        ],\n        password: [\n          { required: true, trigger: 'blur', min: 6, max: 32 },\n          { validator: validatePass, trigger: 'blur' }\n        ],\n        confirmPassword: [\n          { required: true, validator: validateConfirmPass, trigger: 'change' }\n        ]\n      },\n      btnResetLoading: false,\n      captchaId: '',\n      captchaImg: '',\n      token: '',\n      apply: true\n    }\n  },\n  methods: {\n    handleReset: function(name) {\n      this.$refs[name].validate(valid => {\n        if (!valid) {\n          return;\n        }\n        if (this.apply) {\n          const dataForm = {\n            username: this.resetForm.handler,\n            email: this.resetForm.handler,\n            captcha: this.resetForm.captcha,\n            captchaId: this.captchaId\n          }\n          if (this.resetForm.handler.indexOf('@') !== -1) {\n            // 邮件\n            delete dataForm.username;\n          } else {\n            // 用户名\n            delete dataForm.email;\n          }\n          api.forgetPassword(dataForm).then(ret => {\n            this.$Message.success(`重置密码链接已发送到 ${ret}`);\n          }).catch(err => {\n            this.$Message.error(err.message);\n            this.getCaptcha();\n          }).finally(() => {\n            this.resetForm.handler = '';\n            this.resetForm.captcha = '';\n          })\n        } else {\n          const dataForm = {\n            token: this.token,\n            password: this.resetForm.password,\n            captcha: this.resetForm.captcha,\n            captchaId: this.captchaId\n          }\n          api.resetPassword(dataForm).then(ret => {\n            this.$Message.success({\n              content: 'Password resetted, please login',\n              onClose: () => this.$router.replace({ name: 'login' })\n            })\n          }).catch(err => {\n            this.$Message.error(err.message);\n          });\n        }\n      })\n    },\n    onCaptchaInputFocus: function() {\n      if (!this.captchaId) {\n        this.getCaptcha();\n      }\n    },\n    getCaptcha: function() {\n      api.getCaptcha().then(ret => {\n        this.captchaId = ret.captchaId;\n        this.captchaImg = ret.captcha;\n      })\n    }\n  },\n  mounted: function() {\n    if (this.$route.query.token) {\n      this.token = this.$route.query.token;\n      this.apply = false;\n      this.$Message.success('Reset your password');\n    }\n  }\n}\n</script>\n\n<style lang=\"less\" scoped>\n.box {\n  width: 420px;\n  margin: 0 auto;\n  border: 1px solid rgb(185, 185, 185);\n  background-color: #fff;\n  border-radius: 5px;\n  box-shadow: 0 0 10px #f5f7f9;\n}\n\n.title {\n  margin: 0.2em 0;\n  padding: 0 0.5em;\n  position: relative;\n  color: #9e0a11;\n  font-size: 1rem;\n  font-weight: bold;\n  border-bottom: 1px solid rgb(185, 185, 185);\n}\n\n.body {\n  padding: 1.5em 1em 0 1em;\n}\n\n/deep/.ivu-form-item-label {\n  font-weight: 500;\n}\n\n.btns {\n  float: right;\n  margin: 5px 0;\n  .ivu-btn:hover {\n    background: rgba(0, 0, 0, 0.05);\n  }\n  a {\n    color: #000;\n    text-decoration: underline;\n    margin-right: 8px;\n  }\n}\n\n.captcha-img {\n  margin-top: 5px;\n  :hover {\n    cursor: pointer;\n  }\n}\n\n.bottom {\n  border-top: 1px solid rgb(185, 185, 185);\n  padding-right: 10px;\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ResetPass.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ResetPass.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ResetPass.vue?vue&type=template&id=2aaf0e81&scoped=true&\"\nimport script from \"./ResetPass.vue?vue&type=script&lang=js&\"\nexport * from \"./ResetPass.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ResetPass.vue?vue&type=style&index=0&id=2aaf0e81&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"2aaf0e81\",\n  null\n  \n)\n\nexport default component.exports","'use strict';\nvar $ = require('../internals/export');\nvar $indexOf = require('../internals/array-includes').indexOf;\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\nvar arrayMethodUsesToLength = require('../internals/array-method-uses-to-length');\n\nvar nativeIndexOf = [].indexOf;\n\nvar NEGATIVE_ZERO = !!nativeIndexOf && 1 / [1].indexOf(1, -0) < 0;\nvar STRICT_METHOD = arrayMethodIsStrict('indexOf');\nvar USES_TO_LENGTH = arrayMethodUsesToLength('indexOf', { ACCESSORS: true, 1: 0 });\n\n// `Array.prototype.indexOf` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.indexof\n$({ target: 'Array', proto: true, forced: NEGATIVE_ZERO || !STRICT_METHOD || !USES_TO_LENGTH }, {\n  indexOf: function indexOf(searchElement /* , fromIndex = 0 */) {\n    return NEGATIVE_ZERO\n      // convert -0 to +0\n      ? nativeIndexOf.apply(this, arguments) || 0\n      : $indexOf(this, searchElement, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/less-loader/dist/cjs.js??ref--14-0!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ResetPass.vue?vue&type=style&index=0&id=2aaf0e81&lang=less&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/less-loader/dist/cjs.js??ref--14-0!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ResetPass.vue?vue&type=style&index=0&id=2aaf0e81&lang=less&scoped=true&\""],"sourceRoot":""}